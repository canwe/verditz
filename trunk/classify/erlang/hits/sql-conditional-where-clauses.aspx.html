

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head><title>
	Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
</title><meta http-equiv="content-type" content="text/html; charset=UTF-8" /><meta name="author" content="Jeff Smith" /><meta name="Generator" content="Subtext Version 1.9.4.0" /><link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://feeds.feedburner.com/JeffsSqlServerWeblog" /><link type="text/css" rel="stylesheet" href="/skins/_System/csharp.css"></link>
<link type="text/css" rel="stylesheet" href="/skins/_System/commonstyle.css"></link>
<link type="text/css" rel="stylesheet" href="/skins/_System/commonlayout.css"></link>
<link media="print" type="text/css" rel="stylesheet" href="/Skins/AnotherEon001_Advertising/print.css"></link>
<link id="MainStyle" type="text/css" rel="stylesheet" href="/skins/AnotherEon001_Advertising/style.css" /><link id="CustomCss" type="text/css" rel="stylesheet" href="http://weblogs.sqlteam.com/jeffs/customcss.aspx" /><link id="Rsd" rel="EditURI" type="application/rsd+xml" title="RSD" href="http://weblogs.sqlteam.com/jeffs/rsd.xml.ashx" /><link id="AtomLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://feeds.feedburner.com/JeffsSqlServerWeblog" /><script src="/Scripts/common.js" type="text/javascript"></script><script src="/Scripts/tableEffects.js" type="text/javascript"></script><script src="/Scripts/BlogInfo.js" type="text/javascript"></script>
		<script type="text/javascript">
			var subtextAllowedHtmlTags = ['a', 'b', 'strong', 'blockquote', 'i', 'em', 'u', 'strike', 'super', 'sub', 'code'];
			var subtextBlogInfo = new blogInfo('/', '/jeffs/" />');
		</script>
		</head>
	<body>
		<form name="Form1" method="post" action="sql-conditional-where-clauses.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="Form1">
<div>
<input type="hidden" name="PostComment_ascx_ctl00_answer" id="PostComment_ascx_ctl00_answer" value="" />
<input type="hidden" name="__CONTROL_FINGERPRINTS_apnlCommentsWrapper" id="__CONTROL_FINGERPRINTS_apnlCommentsWrapper" value="" />
<input type="hidden" name="__apnlCommentsWrapper$RBS_Store" id="__apnlCommentsWrapper$RBS_Store" value="" />
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="PostComment_ascx_ctl00_encrypted" id="PostComment_ascx_ctl00_encrypted" value="YLJV1D6OcPbPg6ImVXGcdWHJ9NehlkcP2wJCSKLTCOA=" />
<input type="hidden" name="__VIEWSTATE" id="
__VIEWSTATE" value="" />
</div>

<script type="text/javascript">
<!--
var theForm = document.forms['Form1'];
if (!theForm) {
    theForm = document.Form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script>


<script src="/WebResource.axd?d=eBadhrNf2-i8mdM0UGP6GQ2&amp;t=633229019246196846" type="text/javascript"></script>

<script type="text/javascript" src="/WebResource.axd?d=hMGjyQFvcTl9f6tfQsNHTFKKDLzARkqeZhzcYB-9S9pfIoxSo_jcqEyRCCibQTDF0&t=633070870124582666"></script>
<script src="/WebResource.axd?d=PfofdSllPklu-JVfl9YmPZJTd3STnfqZKn9ip3BjJX81&amp;t=633229019246196846" type="text/javascript"></script>
<script src="/WebResource.axd?d=MloE_2YxdmjOApcGcIEEdvFTOrtR6w4T9fgIRmTrz6jMUaBeHwngjiK5-vNo3iPeDS-hzS5WiBl7FfzjtcfiEFKZiRFqsy4F69AICJ_9Abk1&amp;t=633171896392770428" type="text/javascript"></script>
<script type="text/javascript">
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</script>

			
<table width="100%" class="Framework" cellspacing="0" cellpadding="0">
	<tr>
		<td colspan="2">
			
<div id="top">
<table width="100%" cellpadding="8" cellspacing="0">
	<tr>
		<td>
			<h1><a id="Header1_HeaderTitle" class="headermaintitle" title="The Title Of This Blog." href="/jeffs/Default.aspx">Jeff's SQL Server Weblog</a></h1>
			<span id="subtitle">Random Thoughts & Cartesian Products with Microsoft SQL Server</span>

		</td>
		<td valign="top">
		   
		  
		
<!-- Begin -  Site: SQLTeam.com Zone -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
// var ZoneID = 5;
// var ZoneID = getZodeIdForUrl();
var ZoneID = 9
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://bulldog.sqlteam.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=67076&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://bulldog.sqlteam.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=67076&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime + '">'); document.write('</'+'scr'+'ipt>');
}

// --> 
</script>
<noscript>
    <a href="http://bulldog.sqlteam.com/a.aspx?ZoneID=9&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=67076" target="_blank">
    <img src="http://bulldog.sqlteam.com/a.aspx?ZoneID=9&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=67076" width="468" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLTeam.com Zone -->

 

 
		</td>
	</tr>
</table>
</div>
<div id="sub">
<div class="BlogStats">posts - 107, comments - 1314, trackbacks - 64</div></div>




		</td>
	</tr>
	<tr>
		<td rowspan="2" class="LeftCell">
			<div id="leftmenu">
				
					
<h3>My Links</h3>
<ul>
	<li>
		<a id="MyLinks1_HomeLink" title="Link to the home page." href="/jeffs/Default.aspx">Home</a>
	<li>
		<a id="MyLinks1_ContactLink" accesskey="9" title="Contact form." href="/jeffs/contact.aspx">Contact</a>
	<li>
		<a id="MyLinks1_XMLLink" title="Subscribe to this feed." href="http://feeds.feedburner.com/JeffsSqlServerWeblog"><img src="../../../../../images/xml.gif" alt="RSS 2.0 Feed" style="border-width:0px;" /></a>
	<li>
		<a id="MyLinks1_Admin" title="Login Form." href="/jeffs/login.aspx">Login</a></li>
</ul>

<h3>SQLTeam.com Links</h3>
<ul>
    <li><a id="MyLinks1_HyperLink1" href="http://www.sqlteam.com/">SQLTeam.com Articles</a></li>
	<li><a id="MyLinks1_HyperLink2" href="http://weblogs.sqlteam.com/">SQLTeam.com Weblog</a></li>
	<li><a id="MyLinks1_HyperLink3" href="http://www.sqlteam.com/forums/">SQLTeam.com Forums</a></li>
</ul>

					
<h3>News</h3>
<div class="news">
	Welcome to my blog.  My name is Jeff Smith, and I am a software developer in Boston, MA.  Check in frequently for tips, tricks, commentary and ideas on SQL Server and .NET programming.
<br>
<br>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1782498-1";
urchinTracker();
</script>

<!-- feedburner -->
<a href="http://feeds.feedburner.com/JeffsSqlServerWeblog"><img src="http://feeds.feedburner.com/~fc/JeffsSqlServerWeblog?bg=FFFF66&amp;fg=444444&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a>
<br>
<a href="http://feeds.feedburner.com/JeffsSqlServerWeblog" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a>
<a href="http://feeds.feedburner.com/JeffsSqlServerWeblog" rel="alternate" type="application/rss+xml">Subscribe</a>
<br>
<br>
<!-- tall skyscraper -->

<script type="text/javascript"><!--
google_ad_client = "pub-7762921121479231";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
//2007-04-29: SQLTeamWeblogSide
google_ad_channel = "0445486523";
google_color_border = "EEEEEE";
google_color_bg = "EEEEEE";
google_color_link = "008000";
google_color_text = "000000";
google_color_url = "008000";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br>
<br>

<!-- small square ad -->

<script type="text/javascript"><!--
google_ad_client = "pub-7762921121479231";
google_ad_width = 200;
google_ad_height = 200;
google_ad_format = "200x200_as";
google_ad_type = "text_image";
//2007-04-30: SQLTeamWeblogSideSmall
google_ad_channel = "7368966960";
google_color_border = "EEEEEE";
google_color_bg = "EEEEEE";
google_color_link = "008000";
google_color_text = "000000";
google_color_url = "008000";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<br>
<br>

<!-- link bar -->

<div style="position: absolute; top: -18px; left: 2px;">
<script type="text/javascript"><!--
google_ad_client = "pub-7762921121479231";
google_ad_width = 468;
google_ad_height = 15;
google_ad_format = "468x15_0ads_al";
//2007-04-29: SQLTeamHeaderLinkUnit
google_ad_channel = "1174182292";
google_ad_type = "text_image";
google_color_border = "E6E6E6";
google_color_bg = "444444";
google_color_link = "FFFFFF";
google_color_text = "FFFFFF";
google_color_url = "008000";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

					
		<h3>Archives</h3>
		
				<ul>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl01_Link" title="" href="/jeffs/archive/2007/09.aspx">September, 2007 (4)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl02_Link" title="" href="/jeffs/archive/2007/08.aspx">August, 2007 (5)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl03_Link" title="" href="/jeffs/archive/2007/07.aspx">July, 2007 (11)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl04_Link" title="" href="/jeffs/archive/2007/06.aspx">June, 2007 (8)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl05_Link" title="" href="/jeffs/archive/2007/05.aspx">May, 2007 (10)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl06_Link" title="" href="/jeffs/archive/2007/04.aspx">April, 2007 (12)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl07_Link" title="" href="/jeffs/archive/2007/03.aspx">March, 2007 (7)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl08_Link" title="" href="/jeffs/archive/2007/01.aspx">January, 2007 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl09_Link" title="" href="/jeffs/archive/2006/07.aspx">July, 2006 (4)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl10_Link" title="" href="/jeffs/archive/2006/06.aspx">June, 2006 (2)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl11_Link" title="" href="/jeffs/archive/2006/04.aspx">April, 2006 (3)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl12_Link" title="" href="/jeffs/archive/2006/03.aspx">March, 2006 (2)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl13_Link" title="" href="/jeffs/archive/2006/02.aspx">February, 2006 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl14_Link" title="" href="/jeffs/archive/2005/12.aspx">December, 2005 (2)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl15_Link" title="" href="/jeffs/archive/2005/11.aspx">November, 2005 (3)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl16_Link" title="" href="/jeffs/archive/2005/09.aspx">September, 2005 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl17_Link" title="" href="/jeffs/archive/2005/05.aspx">May, 2005 (5)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl18_Link" title="" href="/jeffs/archive/2005/04.aspx">April, 2005 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl19_Link" title="" href="/jeffs/archive/2004/12.aspx">December, 2004 (2)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl20_Link" title="" href="/jeffs/archive/2004/11.aspx">November, 2004 (4)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl21_Link" title="" href="/jeffs/archive/2004/10.aspx">October, 2004 (2)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl22_Link" title="" href="/jeffs/archive/2004/09.aspx">September, 2004 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl23_Link" title="" href="/jeffs/archive/2004/07.aspx">July, 2004 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl24_Link" title="" href="/jeffs/archive/2004/06.aspx">June, 2004 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl25_Link" title="" href="/jeffs/archive/2004/05.aspx">May, 2004 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl26_Link" title="" href="/jeffs/archive/2004/03.aspx">March, 2004 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl27_Link" title="" href="/jeffs/archive/2004/01.aspx">January, 2004 (1)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl28_Link" title="" href="/jeffs/archive/2003/12.aspx">December, 2003 (3)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl29_Link" title="" href="/jeffs/archive/2003/11.aspx">November, 2003 (4)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl30_Link" title="" href="/jeffs/archive/2003/10.aspx">October, 2003 (2)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl31_Link" title="" href="/jeffs/archive/2003/09.aspx">September, 2003 (2)</a> </li>
			
				</ul>
			
	
		<h3>Post Categories</h3>
		
				<ul>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl01_Link" title="" href="/jeffs/category/158.aspx">.NET (C# / VB)</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl01_RssLink" title="Subscribe to .NET (C# / VB)" href="/jeffs/category/158.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl02_Link" title="" href="/jeffs/category/157.aspx">ASP</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl02_RssLink" title="Subscribe to ASP" href="/jeffs/category/157.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl03_Link" title="" href="/jeffs/category/239.aspx">ASP.NET</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl03_RssLink" title="Subscribe to ASP.NET" href="/jeffs/category/239.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl04_Link" title="" href="/jeffs/category/241.aspx">Code Library - ASP.NET</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl04_RssLink" title="Subscribe to Code Library - ASP.NET" href="/jeffs/category/241.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl05_Link" title="" href="/jeffs/category/242.aspx">Code Library - C# / VB.NET</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl05_RssLink" title="Subscribe to Code Library - C# / VB.NET" href="/jeffs/category/242.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl06_Link" title="" href="/jeffs/category/240.aspx">Code Library - SQL</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl06_RssLink" title="Subscribe to Code Library - SQL" href="/jeffs/category/240.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl07_Link" title="" href="/jeffs/category/156.aspx">CrossTabs / Pivoting Data</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl07_RssLink" title="Subscribe to CrossTabs / Pivoting Data" href="/jeffs/category/156.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl08_Link" title="" href="/jeffs/category/243.aspx">Database Design</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl08_RssLink" title="Subscribe to Database Design" href="/jeffs/category/243.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl09_Link" title="" href="/jeffs/category/283.aspx">DateTime Data</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl09_RssLink" title="Subscribe to DateTime Data" href="/jeffs/category/283.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl10_Link" title="" href="/jeffs/category/163.aspx">Efficiency</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl10_RssLink" title="Subscribe to Efficiency" href="/jeffs/category/163.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl11_Link" title="" href="/jeffs/category/254.aspx">GROUP BY</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl11_RssLink" title="Subscribe to GROUP BY" href="/jeffs/category/254.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl12_Link" title="" href="/jeffs/category/164.aspx">Humor</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl12_RssLink" title="Subscribe to Humor" href="/jeffs/category/164.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl13_Link" title="" href="/jeffs/category/249.aspx">Imports/Exports</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl13_RssLink" title="Subscribe to Imports/Exports" href="/jeffs/category/249.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl14_Link" title="" href="/jeffs/category/248.aspx">Joins/Relations</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl14_RssLink" title="Subscribe to Joins/Relations" href="/jeffs/category/248.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl15_Link" title="" href="/jeffs/category/247.aspx">Links</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl15_RssLink" title="Subscribe to Links" href="/jeffs/category/247.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl16_Link" title="" href="/jeffs/category/154.aspx">Miscellaneous</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl16_RssLink" title="Subscribe to Miscellaneous" href="/jeffs/category/154.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl17_Link" title="" href="/jeffs/category/161.aspx">MS Access</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl17_RssLink" title="Subscribe to MS Access" href="/jeffs/category/161.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl18_Link" title="" href="/jeffs/category/162.aspx">Paging Data</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl18_RssLink" title="Subscribe to Paging Data" href="/jeffs/category/162.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl19_Link" title="" href="/jeffs/category/238.aspx">Report Writing</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl19_RssLink" title="Subscribe to Report Writing" href="/jeffs/category/238.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl20_Link" title="" href="/jeffs/category/237.aspx">Security</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl20_RssLink" title="Subscribe to Security" href="/jeffs/category/237.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl21_Link" title="" href="/jeffs/category/159.aspx">Sports</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl21_RssLink" title="Subscribe to Sports" href="/jeffs/category/159.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl22_Link" title="" href="/jeffs/category/213.aspx">SQL Server 2005</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl22_RssLink" title="Subscribe to SQL Server 2005" href="/jeffs/category/213.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl23_Link" title="" href="/jeffs/category/282.aspx">SQL Server 2008</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl23_RssLink" title="Subscribe to SQL Server 2008" href="/jeffs/category/282.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl24_Link" title="" href="/jeffs/category/160.aspx">Techniques</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl24_RssLink" title="Subscribe to Techniques" href="/jeffs/category/160.aspx/rss">(rss)</a></li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl25_Link" title="" href="/jeffs/category/155.aspx">T-SQL</a> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl25_RssLink" title="Subscribe to T-SQL" href="/jeffs/category/155.aspx/rss">(rss)</a></li>
			
				</ul>
			
	
		<h3>Programming</h3>
		
				<ul>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl01_Link" title="" href="http://msdn.microsoft.com/netframework/">MSDN - .NET Framework</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl02_Link" title="" rel="external" href="http://www.Worsethanfailure.com">The DailyWTF</a> </li>
			
				</ul>
			
	
		<h3>Sports</h3>
		
				<ul>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl03_LinkList_ctl01_Link" title="" href="http://www.baseballreference.com">Baseball Reference.com</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl03_LinkList_ctl02_Link" title="" rel="external" href="http://baseball1.com/">Baseball Stats Database</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl03_LinkList_ctl03_Link" title="" rel="external" href="http://www.redsoxfoundation.org">Red Sox Foundation</a> </li>
			
				</ul>
			
	
		<h3>SQL</h3>
		
				<ul>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl04_LinkList_ctl01_Link" title="" rel="external" href="http://www.microsoft.com/sql/">Microsoft SQL Server</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl04_LinkList_ctl02_Link" title="" rel="external" href="http://www.microsoft.com/technet/prodtechnol/sql/community/default.mspx">Microsoft TechNet - SQL</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl04_LinkList_ctl03_Link" title="" rel="external" href="http://blogs.msdn.com/sqlexpress/">SQL Server Express WebLog</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl04_LinkList_ctl04_Link" title="" rel="external" href="http://sqlblog.com/default.aspx">SQLBog.com</a> </li>
			
				</ul>
			
	

				
				
			</div>
		</td>
		<td class="MainCell">
			<div id="main">
				
					
<div class="previousNext">
	<a id="viewpost_ascx_PreviousNext_PrevLink" title="previous post" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/14/sql-filter-by-month.aspx"><< Filtering transactions by month (plus other time periods)</a>
	<span id="viewpost_ascx_PreviousNext_LeftPipe" class="prevNextSeparator"> | </span>
	<a id="viewpost_ascx_PreviousNext_MainLink" href="/jeffs/Default.aspx">Home</a>
	<span id="viewpost_ascx_PreviousNext_RightPipe" class="prevNextSeparator"> | </span>
	<a id="viewpost_ascx_PreviousNext_NextLink" title="next post" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/27/sql-nullif-function.aspx">A handy but little-known SQL function: NULLIF() >></a>
</div>


	<div class="post">
		<h2>
			<a id="viewpost_ascx_TitleUrl" title="Title of this entry." href="/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx">Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions</a>
		</h2>
		Often, we need to create a flexible stored procedure that returns data that is optionally filtered by some parameters. If you wish to apply a filter, you set the parameter to the necessary value, if not, you leave it null.  This is pretty standard stuff, of course, that we can write fairly easily, without the need for dynamic SQL, like this:<br />
<br />
<div style="margin-left: 40px;"><span style="font-family: Courier New;">create procedure GetData </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    @MinDate int = null,</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    @MaxDate int = null,</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    @MinAmount money = null,</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    @MaxAmount money = null,<br />
</span><span style="font-family: Courier New;">    @ProductCode varchar(200) = null,</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    @CompanyID int</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">as</span><br style="font-family: Courier New;" />
<br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    select *</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    from Data</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    where</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        (@MinDate is null OR @MinDate &lt;= Date) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        (@MaxDate is null OR @MaxDate &gt;= Date) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        (@MinAmount is null OR @MinAmount &gt;= Amount) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        (@MaxAmount is null OR @MaxAmount &lt;= Amount) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        (@ProductCode  is null OR ProductCode = @ProductCode) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        (@CompanyID is null OR CompanyID = @CompanyID)</span><br />
</div>
<br />
Note that we are using good boolean algebra as discussed <a href="http://weblogs.sqlteam.com/jeffs/archive/2003/11/14/513.aspx">here</a>, and not using inefficient CASE or COALESCE() expressions around the columns in our WHERE clause.  It is pretty easy to read and quite logical, and certainly it is easy to edit and to extend with more filtering options as necessary.  We also made sure to use parenthesis in our WHERE clause to organize it and to enforce a clear and correct order of operations regarding our AND and OR clauses.<br />
<br />
However, if we manipulate our parameters a little and re-organize our criteria, we can potentially write this much more efficiently.<br />
<br />
First, note that we are allowing the user to specify an optional date range via the @MinDate and @MaxDate parameters.  If either is NULL, we simply do not use a minimum or maximum date in our filter.  However, we can simplify things by writing our criteria like this:<br />
<span style="font-family: Courier New;"><br />
</span>
<div style="margin-left: 40px;"><span style="font-family: Courier New;">select *</span><span style="font-family: Courier New;"></span><br />
<span style="font-family: Courier New;">from Data</span><br />
<span style="font-family: Courier New;"></span><span style="font-family: Courier New;">where</span><span style="font-family: Courier New;"></span><br />
<span style="font-family: Courier New; font-weight: bold;">Date between coalesce(@MinDate, '1/1/1900') and coalesce</span><span style="font-family: Courier New;"><span style="font-weight: bold;">(@MaxDate, '12/31/2999')</span> and </span><br />
<span style="font-family: Courier New;">... etc </span><br />
</div>
<br />
All we need to do is use COALESCE() to transform our NULL values to dates that will encompass the entire range of values, thus "eliminating" that filter from the results. This greatly simplifies our WHERE clause and ensures that indexes on our Date column can be used.  <br />
<br />
We can do the exact same thing for our Amount range as well:<br />
<br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    select *</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    from Data</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    where</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Date between coalesce(@MinDate, '1/1/1900') and coalesce(@MaxDate, '12/31/2999') and </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        <span style="font-weight: bold;">Amount between coalesce(@MinAmount,-99999999) and coalesce(@MaxAmount,99999999)</span> and ...</span><br />
<br />
For numeric values, this can be trickier because you really want to make sure that you have your entire range of values covered.  When in doubt, just use the smallest and largest possible values that your data type will allow.<br />
<br />
Next, we have a string comparison based on product code.  These also can be very efficiently rewritten by using LIKE.  Normally, LIKE is much slower than using equals, but if you do not use any wild cards and it allows you to eliminate an "OR" in your WHERE clause, it may actually be more efficient:<br />
<br />
<span style="font-family: Courier New;">    select *</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    from Data</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    where</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Date between coalesce(@MinDate, '1/1/1900') and coalesce(@MaxDate, '12/31/2999') and </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Amount between coalesce(@MinAmount,-999999999) and coalesce(@MaxAmount,999999999) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        <span style="font-weight: bold;">ProductCode like coalesce(@ProductCode,'%')</span> and ...</span><br />
<br />
Note that if your product codes contain symbols like % or _, this will not work for you.  But in general, using LIKE in this case can be really handy.  I also sometimes see this:<br />
<br />
<div style="margin-left: 40px;"><span style="font-family: Courier New;">where (@Name is null OR Name like '%' + @Name + '%')<br />
<br />
</span></div>
.. which can of course be written much simply and more efficiently, since we are using LIKE already, as:<br />
<br />
<div style="margin-left: 40px;"><span style="font-family: Courier New;">where (Name like '%' + coalesce(@Name,'') + '%')<br />
<br />
</span></div>
The idea is to eliminate those OR operators and simplify your WHERE condition wherever possible.<br />
<br />
Finally, we have an optional filter for a specific @CompanyID integer parameter.  We don't want to use a LIKE wildcard, since this will require that all of the integer values in the table must be converted to strings for the comparison -- thus, no indexes will be used.  What we can do, even though it might not seem intuitive, is use a range!  For example:<br />
<br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    select *</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    from Data</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    where</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Date between coalesce(@MinDate, '1/1/1900') and coalesce(@MaxDate, '12/31/2999') and </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Amount between coalesce(@MinAmount,-99999999) and coalesce(@MaxAmount,99999999) and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        ProductCode like coalesce(@ProductCode,'%') and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        <span style="font-weight: bold;">CustomerID between coalesce(@CustomerID,0) and coalesce(@CustomerID,999999999)</span></span><br />
<br />
Now, we have no ORs in our WHERE clause at all, and we have not wrapped any columns in our table in any expressions, so all indexes can potentially be used.  Our SQL is still relatively clear and easy to read and work with, and we can easily add more conditions or criteria as necessary.<br />
<br />
You may also find that it is more efficient and/or easier to maintain if you first set your parameter values as necessary before the SELECT, like this:<br />
<span style="font-family: Courier New;"><br />
    declare @MinID int, @MaxID int</span><br />
<div style="margin-left: 40px;"><span style="font-family: Courier New;"></span></div>
<span style="font-family: Courier New;"> <br style="font-family: Courier New;" />
</span><span style="font-family: Courier New;">    set @MinDate = coalesce(@MinDate, '1/1/1900') </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    set @MaxDate = coalesce(@MaxDate,'12/31/2999')</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    set @MinAmount = coalesce(@MinAmount,-99999999) </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    set @MaxAmount = coalesce(@MaxAmount,99999999)</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    set @ProductCode = coalesce(@ProductCode,'%')</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    set @MinID = coalesce(@CustomerID,-99999999) </span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    set @MaxID = coalesce(@</span><span style="font-family: Courier New;">CustomerID</span><span style="font-family: Courier New;">,99999999)</span><br style="font-family: Courier New;" />
<br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    select *</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    from Data</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">    where</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Date between @MinDate and @MaxDate and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        Amount between @MinAmount and @MaxAmount and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        ProductCode like @ProductCode and</span><br style="font-family: Courier New;" />
<span style="font-family: Courier New;">        CustomerID between @MinID and @MaxID</span><br />
<br />
This will ensure that the coalesce() expressions are evaluated only once, and it does make things a little easier to read.<br />
<br />
The overall trick is to think to yourself: Can I take a parameter value and either alter it or use it to create new values, and then efficiently use those new values in my WHERE clause <span style="font-style: italic;">instead</span> of simply using that raw parameter value?  Sometimes, it takes some "outside-of-the-box" thinking, but it often can be done and the resulting performance gains can be tremendous.<br />
<br />
Ultimately, you always should test the different ways of writing your WHERE clauses and always double check the indexing on your tables to get the maximum efficiency.  Writing things a particular way in one situation may work great, but then applying it to another may not work quite as well. <br />
<br />
<span style="font-style: italic;"> See also: </span><br />
<ul>
    <li><a href="http://weblogs.sqlteam.com/jeffs/archive/2003/11/14/513.aspx">SQL WHERE clauses: Avoid CASE, use Boolean logic</a></li>
    <li><a target="_blank" href="http://www.sqlteam.com/article/avoid-enclosing-indexed-columns-in-a-function-in-the-where-clause">Avoid enclosing Indexed Columns in a Function in the WHERE clause</a></li>
</ul>
		<p class="postfoot">
			<a href="javascript:window.print();" class="printIcon"><span>Print</span></a> | posted on Tuesday, September 18, 2007 4:25 PM
		</p>
	</div>
	<link rel="pingback" href="http://weblogs.sqlteam.com/jeffs/Services/Pingback.aspx"></link>
	
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx"
dc:identifier="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx"
dc:title="Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions"
trackback:ping="http://weblogs.sqlteam.com/jeffs/services/trackbacks/60328.aspx" />
</rdf:RDF>
-->

	<span id='apnlCommentsWrapper$RBS_Holder'><span id="apnlCommentsWrapper" AjaxCall="async">
<a name="feedback" title="feedback anchor"></a>
<div id="comments">
<h3>Feedback</h3>
	
	
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37323">#</a>&nbsp;<a name="37323"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl00_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl00$EditLink','')"></a>
				</h2>
				nice!<br /><br />i usually just set the default values to parameters in the sproc, so i don't have to even use coalesce
				<div class="postfoot">
					9/18/2007 4:51 PM | <a id="Comments_ascx_CommentList_ctl00_NameLink" title="http://weblogs.sqlteam.com/mladenp" href="http://weblogs.sqlteam.com/mladenp" target="_blank">Mladen</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37324">#</a>&nbsp;<a name="37324"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl01_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl01$EditLink','')"></a>
				</h2>
				An even better idea!  I do that sometimes as well.
				<div class="postfoot">
					9/18/2007 4:59 PM | <a id="Comments_ascx_CommentList_ctl01_NameLink" class="author" title="http://weblogs.sqlteam.com/JeffS" href="http://weblogs.sqlteam.com/JeffS" target="_blank">Jeff</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37325">#</a>&nbsp;<a name="37325"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl02_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl02$EditLink','')"></a>
				</h2>
				I think this:<br /><br />    set @MinID = coalesce(@MinID,-99999999)<br />    set @MaxID = coalesce(@MaxID,99999999)<br /><br />Should be this:<br /><br />    set @MinID = coalesce(@CustomerID,-99999999)<br />    set @MaxID = coalesce(@CustomerID,99999999)
				<div class="postfoot">
					9/18/2007 5:46 PM | <a id="Comments_ascx_CommentList_ctl02_NameLink" title="http://encosia.com/" href="http://encosia.com/" target="_blank">Dave</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37326">#</a>&nbsp;<a name="37326"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl03_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl03$EditLink','')"></a>
				</h2>
				Fixed, thanks Dave!
				<div class="postfoot">
					9/18/2007 6:08 PM | <a id="Comments_ascx_CommentList_ctl03_NameLink" class="author" title="http://weblogs.sqlteam.com/Jeffs" href="http://weblogs.sqlteam.com/Jeffs" target="_blank">Jeff</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37327">#</a>&nbsp;<a name="37327"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl04_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl04$EditLink','')"></a>
				</h2>
				I use some of these techniques already, but this is good stuff.<br /><br />To the posters above: Beware default parameters: parameter sniffing may occur.
				<div class="postfoot">
					9/19/2007 1:39 AM | <a id="Comments_ascx_CommentList_ctl04_NameLink" title="gbn" target="_blank">gbn</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37328">#</a>&nbsp;<a name="37328"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl05_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl05$EditLink','')"></a>
				</h2>
				I've always been torn between using COALESCE vs. ISNULL.  I like COALESCE because its ANSI compliant and can support more arguments, but I like ISNULL also because for this kind of thing its a bit clearer what is going on.<br /><br />Also ISNULL has the apparent behavior of truncating the result to the size of the variable placeholder, for good or bad.<br /><br />You know if there is any difference in speed between the 2?
				<div class="postfoot">
					9/19/2007 2:46 AM | <a id="Comments_ascx_CommentList_ctl05_NameLink" title="http://www.bostongis.com/blog" href="http://www.bostongis.com/blog" target="_blank">Regina</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37329">#</a>&nbsp;<a name="37329"></a>re: Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl06_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl06$EditLink','')"></a>
				</h2>
				yes isnull is faster.<br />google up coalesce vs isnull speed
				<div class="postfoot">
					9/19/2007 3:04 AM | <a id="Comments_ascx_CommentList_ctl06_NameLink" title="http://weblogs.sqlteam.com/mladenp" href="http://weblogs.sqlteam.com/mladenp" target="_blank">Mladen</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37332">#</a>&nbsp;<a name="37332"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl07_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl07$EditLink','')"></a>
				</h2>
				Great idea! Thanks!
				<div class="postfoot">
					9/19/2007 2:45 PM | <a id="Comments_ascx_CommentList_ctl07_NameLink" title="http://pietschsoft.com/" href="http://pietschsoft.com/" target="_blank">Chris Pietschmann</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37335">#</a>&nbsp;<a name="37335"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl08_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl08$EditLink','')"></a>
				</h2>
				Yup ! all this works well if the parameter has single value. But what if i have comma separated multiple values in my paramater? something like this:<br /><br />select g.name from geography g<br />where (p_Country is null or g.id in (p_country))<br /><br />p_country has multiple values :1,2,3,4,5<br /><br />for such multiple cases, even the above code doesnt work. The in clause actually fails here.Anyone has any better idea to resolve this?<br /><br />Thanks,<br />Rashmi
				<div class="postfoot">
					9/20/2007 7:06 AM | <a id="Comments_ascx_CommentList_ctl08_NameLink" title="Rashmi" target="_blank">Rashmi</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37344">#</a>&nbsp;<a name="37344"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl09_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl09$EditLink','')"></a>
				</h2>
				Ummm, I suggest trying this with some real-world data to see exactly how bad an idea this is.<br /><br />In most cases, and as the procedure is written, procedure allow null input values such as @MinDate because the caller doesn't _care_ about the value of the Date column in the table, not that they are trying to retrieve rows with a null Date value.  In other words, we don't want to seek against this predicate _at all_.<br /><br />By using COALESCE or ISNULL to coerce the null input parameter to a fake real parameter, you force the parameter to be used in refining the rowset, when in fact you want it to be ignored completely (which is what the query engine will do - again, I suggest trying this against some real data).<br /><br />In addition, it's inelegant, decreased readability, and promotes bug to coerce parameters to constants.  In this case, your code will break starting 12/31/2999, because SQL Server datetime can actually go up to 12/31/9999.   :-)
				<div class="postfoot">
					9/20/2007 10:40 AM | <a id="Comments_ascx_CommentList_ctl09_NameLink" title="Mark Routbort" target="_blank">Mark Routbort</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37357">#</a>&nbsp;<a name="37357"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl10_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl10$EditLink','')"></a>
				</h2>
				Hi Mark -- thanks for your feedback. <br /><br />First off, of course you don't use this when your dates contain nulls!  I hope you didn't think I was presenting a "rule" that states "always write your WHERE clause like this" !  My entire point was to analyze your SQL to see if there might be a more efficient way to code it, depending on your needs.  that's all.  If you have nulls and want them returned in your data, of course you wouldn't use a date range!  And, of course you wouldn't use a NULL value as a default parameter, either -- otherwise, how you do express to return NULL dates or not?  You can't.<br /><br />As for testing, did you test it?  Care to give an example that demonstrates how "bad this idea is"?   All of my testing shows that it is at worst the same, and more often more efficient than using lots of OR's, especially as other conditions are added or included in your WHERE clause.  I could not come up with a scenario where it performed worse -- can you?<br /><br />Finally, I will just assume that you are joking about the code breaking in year 2999 ... ... kind of hard to tell for sure based on the tone in the rest of your comments.
				<div class="postfoot">
					9/20/2007 2:13 PM | <a id="Comments_ascx_CommentList_ctl10_NameLink" class="author" title="http://weblogs.sqlteam.com/JeffS" href="http://weblogs.sqlteam.com/JeffS" target="_blank">Jeff</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37361">#</a>&nbsp;<a name="37361"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl11_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl11$EditLink','')"></a>
				</h2>
				Mark -- by the way, just for the record -- I prefer to write it the logically correct way with the OR conditions, it is just that often it ends up not generating a good execution plan, especially prior to SQL 2005.  Sometimes, though, if you make little substitutions as I suggested, you may find that are able to tweak things to get better performance.
				<div class="postfoot">
					9/20/2007 4:01 PM | <a id="Comments_ascx_CommentList_ctl11_NameLink" class="author" title="http://weblogs.sqlteam.com/JeffS" href="http://weblogs.sqlteam.com/JeffS" target="_blank">Jeff</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37365">#</a>&nbsp;<a name="37365"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl12_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl12$EditLink','')"></a>
				</h2>
				Jeff - <br /><br />Yes, I did test this against a relatively cost-intensive stored procedure we have in a production system (SQL 2000, btw) where we use a similar approach to your initial example to allow optional parameters, which if unspecified do not constain the result set.  This procedure nearly always is exercised with the optional parameters set to null.  For this particular example, converting a fragment of my WHERE predicate from <br /><br />                        ( @start_date IS NULL or<br />                          acc2.created_date &gt;= @start_date ) AND<br />                        ( @end_date IS NULL or<br />                          acc2.created_date &lt;= @end_date )<br /><br />to<br /><br />                          acc2.created_date &gt;= ISNULL(@start_date,'1/1/1900')<br />                          AND<br />                          acc2.created_date &lt;= ISNULL(@end_date,'12/31/9999')<br /><br />resulted in more than doubling the Reads in SQL Profiler when executing the stored procedure.  The deck is stacked, or so I thought, against the latter expression since as it turns out there is no index on the column [created_date] (as I said, in production this is really only run with unconstrained dates).  This lead me to think that the query engine was smart enough to optimize out redundant OR conditions generally, and that by using ISNULL or COALESCE you are forcing an unecessary index seek or table scan to occur.<br /><br />I also got horrific performance when I switched the order in my original predicate to <br /><br />                        ( acc2.created_date &gt;= @start_date <br />                           OR @start_date IS NULL) AND<br />                        ( acc2.created_date &lt;= @end_date <br />                           OR @end_date IS NULL)<br /><br />which again led me to believe that the query engine was performing some form of logic short-circuiting.<br /><br />However, I was unable to get a working example to show you with a non-complex underlying table &amp; procedure architecture, so I think things are more complex than I assumed. <br /><br />I withdraw my objection to your suggestion on the basis of performance.   I guess we would probably agree on starting with code that is elegant and readable, and then going on to optimization from there.  I was in fact joking about needing to worry that your code will break in a thousand years, but depending on boundary literals will probably burn you sometime, and in my opinion, should only be used if you can demonstrate through tracing or execution plan analysis that it will help your performance.<br />
				<div class="postfoot">
					9/20/2007 9:46 PM | <a id="Comments_ascx_CommentList_ctl12_NameLink" title="Mark Routbort" target="_blank">Mark Routbort</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37372">#</a>&nbsp;<a name="37372"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl13_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl13$EditLink','')"></a>
				</h2>
				&gt;&gt;I guess we would probably agree on starting with code that is elegant and readable, and then going on to optimization from there.<br /><br />Absolutely, Mark! I definitely agree with that. I don't know if you follow it or saw it, but in this article I even linked to a much older post of mine that recommends the simple boolean method for implementing this kind of thing.<br /><br />It is frustrating sometimes, because it is very hard to predict exactly what the optimizer will do. Sometimes switching the order of things in your criteria makes a difference, other times it doesn't, and other times you need to write your criteria in a way that you *think* is actually less elegant or efficient, but then performance improves dramatically. Then, you try that same technique again elsewhere, and performance suffers ... overall, I hope I was able to communicate that these are only suggestions and ideas and the overall point is to sometimes step back and think about different ways you can use your parameters to construct your WHERE clause to tweak things, if necessary, which may help improve performance.<br /><br />Thanks for your follow up and your feedback!<br />
				<div class="postfoot">
					9/21/2007 8:51 AM | <a id="Comments_ascx_CommentList_ctl13_NameLink" class="author" title="http://weblogs.sqlteam.com/JeffS" href="http://weblogs.sqlteam.com/JeffS" target="_blank">Jeff</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37390">#</a>&nbsp;<a name="37390"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl14_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl14$EditLink','')"></a>
				</h2>
				<br />Just be careful when wrapping a function around an indexed column.... it will nullify the use of any index.
				<div class="postfoot">
					9/23/2007 7:37 PM | <a id="Comments_ascx_CommentList_ctl14_NameLink" title="AP" target="_blank">AP</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37391">#</a>&nbsp;<a name="37391"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl15_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl15$EditLink','')"></a>
				</h2>
				AP -- uh, thanks!  That's kind of the entire point of my post ....
				<div class="postfoot">
					9/23/2007 7:50 PM | <a id="Comments_ascx_CommentList_ctl15_NameLink" class="author" title="http://weblogs.sqlteam.com/Jeffs" href="http://weblogs.sqlteam.com/Jeffs" target="_blank">Jeff</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37392">#</a>&nbsp;<a name="37392"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl16_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl16$EditLink','')"></a>
				</h2>
				There's a bug in the range filters in your original query. For the date and amount, you have:<br /><br />(@Min is null OR @Min &gt;= value) and<br />(@Max is null OR @Max &lt;= value)<br /><br />This will only return records where the value is less than the minimum and greater than the maximum. This should, of course, read:<br /><br />(@Min is null OR @Min &lt;= value) and<br />(@Max is null OR @Max &gt;= value)
				<div class="postfoot">
					9/24/2007 7:35 AM | <a id="Comments_ascx_CommentList_ctl16_NameLink" title="Richard" target="_blank">Richard</a>
				</div>
			</div>
		
		    
			<div class="post">
				<h2>
					<a title="permalink: re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" href="http://weblogs.sqlteam.com/jeffs/archive/2007/09/18/sql-conditional-where-clauses.aspx#37393">#</a>&nbsp;<a name="37393"></a>re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions
					<a id="Comments_ascx_CommentList_ctl17_EditLink" href="javascript:__doPostBack('Comments_ascx$CommentList$ctl17$EditLink','')"></a>
				</h2>
				Thanks, Richard! Fixed!
				<div class="postfoot">
					9/24/2007 8:24 AM | <a id="Comments_ascx_CommentList_ctl17_NameLink" class="author" title="http://weblogs.sqlteam.com/JeffS" href="http://weblogs.sqlteam.com/JeffS" target="_blank">Jeff</a>
				</div>
			</div>
		
</div>
<div id="commentform">
<h3>Post Comment</h3>
	<table cellSpacing="1" cellPadding="1" border="0">
		<tr>
			<td>Title</td>
			<td>
				<input name="PostComment_ascx$tbTitle" type="text" value="re: Optimizing Conditional WHERE Clauses: Avoiding ORs and CASE Expressions" maxlength="128" id="PostComment_ascx_tbTitle" class="Textbox" Size="40" style="width:300px;" /></td>
			<td>
				<span id="PostComment_ascx_RequiredFieldValidator1" style="color:Red;visibility:hidden;">Please enter a title</span></td>
		</tr>
		<tr>
			<td>Name</td>
			<td>
				<input name="PostComment_ascx$tbName" type="text" maxlength="32" id="PostComment_ascx_tbName" class="Textbox" Size="40" style="width:300px;" /></td>
			<td>
				<span id="PostComment_ascx_RequiredFieldValidator2" style="color:Red;visibility:hidden;">Please enter your name</span></td>
		</tr>
		<tr>
			<td>Email</td>
			<td>
				<input name="PostComment_ascx$tbEmail" type="text" maxlength="128" id="PostComment_ascx_tbEmail" class="Textbox" Size="40" style="width:300px;" />
			</td>
			<td>
				<span id="PostComment_ascx_vldEmail" style="color:Red;display:none;">Email is not required, but it must be valid if specified.</span>
			</td>
		</tr>		
		<tr>
			<td>Url</td>
			<td>
				<input name="PostComment_ascx$tbUrl" type="text" maxlength="256" id="PostComment_ascx_tbUrl" class="Textbox" Size="40" style="width:300px;" />
			</td>
			<td>
				<span id="PostComment_ascx_vldUrl" style="color:Red;display:none;">Url is not required, but it must be valid if specified.</span>
			</td>
		</tr>
		<tr>
			<td colSpan="3">Comment&nbsp;
				<span id="PostComment_ascx_RequiredFieldValidator3" style="color:Red;visibility:hidden;">Please enter a comment</span><br />
				<textarea name="PostComment_ascx$tbComment" rows="10" cols="50" id="PostComment_ascx_tbComment" style="height:193px;width:100%;"></textarea></td>
		</tr>
		<tr>
			<td colSpan="3">
				<input id="PostComment_ascx_chkRemember" type="checkbox" name="PostComment_ascx$chkRemember" checked="checked" /><label for="PostComment_ascx_chkRemember">Remember Me?</label></td>
		</tr>
		<tr>
			<td>
				<span id="PostComment_ascx_ctl00" style="color:Red;display:none;">Please enter the answer to the supplied question.</span><span id="PostComment_ascx_ctl00_subtext_captcha">Please add 6 and 3 and type the answer here: <input type="text" name="PostComment_ascx_ctl00_visibleanswer" value="" /></span><input type="hidden" name="PostComment_ascx_captcha_encrypted" value="39mdc6Ieavug/gH1eBNcKvT0VL0uBz2QVe5cV+mWASc=" /><div id="PostComment_ascx_captcha" class="captcha"><img src="/CaptchaImage.ashx?spec=vH%2b70J7vOK4kECDk2alO8SUYGF3U1KRFPHRmp6aqMcxT04gln0GQksY4xD673L%2bo" border="0" width="180"  height="50"  /><label for="PostComment_ascx_captcha_answer">Enter the code shown above:</label><span id="PostComment_ascx_captcha" style="display:inline-block;color:Red;height:50px;width:180px;display:none;">Please enter the correct word</span><input name="PostComment_ascx_captcha_answer" type="text" size="4" maxlength="4" value="" /></div><input type="submit" name="PostComment_ascx$btnSubmit" value="Submit" onclick="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;PostComment_ascx$btnSubmit&quot;, &quot;&quot;, true, &quot;SubtextComment&quot;, &quot;&quot;, false, false))" id="PostComment_ascx_btnSubmit" class="Button" /></td>
			<td colspan="2">
				<span id="PostComment_ascx_Message" style="color:Red;"></span></td>
		</tr>
	</table>
</div>
</span></span>
				
			</div>
		</td>
	</tr>
	<tr>
		<td class="FooterCell">
			
<p id="footer">
	<p class="powererdby">
	Powered by: <br />
	<a id="Footer1_Hyperlink2" title="Powered By Subtext" NAME="Hyperlink1" href="http://sourceforge.net/projects/subtext/"><img title="Powered By Subtext" src="../../../../../images/PoweredBySubtext85x33.png" style="border-width:0px;" /></a>
	<a id="Footer1_Hyperlink3" title="Powered By ASP.NET" href="http://ASP.NET"><img title="Powered By ASP.NET" src="../../../../../images/PoweredByAsp.Net.gif" style="border-width:0px;" /></a>
	</p>
	<p class="copyright">
	Copyright &copy; Jeff Smith
	</p>
</p>
		</td>
	</tr>
</table>

		
<script type="text/javascript">
<!--
var RBS_Controls =  new Array(document.getElementById("apnlCommentsWrapper$RBS_Holder"));
var RBS_Controls_Store =  new Array(document.Form1["__apnlCommentsWrapper$RBS_Store"]);
var Page_Validators =  new Array(document.getElementById("PostComment_ascx_RequiredFieldValidator1"), document.getElementById("PostComment_ascx_RequiredFieldValidator2"), document.getElementById("PostComment_ascx_vldEmail"), document.getElementById("PostComment_ascx_vldUrl"), document.getElementById("PostComment_ascx_RequiredFieldValidator3"), document.getElementById("PostComment_ascx_ctl00"), document.getElementById("PostComment_ascx_captcha"));
// -->
</script>

<script type="text/javascript">
<!--
var PostComment_ascx_RequiredFieldValidator1 = document.all ? document.all["PostComment_ascx_RequiredFieldValidator1"] : document.getElementById("PostComment_ascx_RequiredFieldValidator1");
PostComment_ascx_RequiredFieldValidator1.controltovalidate = "PostComment_ascx_tbTitle";
PostComment_ascx_RequiredFieldValidator1.errormessage = "Please enter a title";
PostComment_ascx_RequiredFieldValidator1.validationGroup = "SubtextComment";
PostComment_ascx_RequiredFieldValidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
PostComment_ascx_RequiredFieldValidator1.initialvalue = "";
var PostComment_ascx_RequiredFieldValidator2 = document.all ? document.all["PostComment_ascx_RequiredFieldValidator2"] : document.getElementById("PostComment_ascx_RequiredFieldValidator2");
PostComment_ascx_RequiredFieldValidator2.controltovalidate = "PostComment_ascx_tbName";
PostComment_ascx_RequiredFieldValidator2.errormessage = "Please enter your name";
PostComment_ascx_RequiredFieldValidator2.validationGroup = "SubtextComment";
PostComment_ascx_RequiredFieldValidator2.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
PostComment_ascx_RequiredFieldValidator2.initialvalue = "";
var PostComment_ascx_vldEmail = document.all ? document.all["PostComment_ascx_vldEmail"] : document.getElementById("PostComment_ascx_vldEmail");
PostComment_ascx_vldEmail.controltovalidate = "PostComment_ascx_tbEmail";
PostComment_ascx_vldEmail.errormessage = "Email is not required, but it must be valid if specified.";
PostComment_ascx_vldEmail.display = "Dynamic";
PostComment_ascx_vldEmail.validationGroup = "SubtextComment";
PostComment_ascx_vldEmail.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
PostComment_ascx_vldEmail.validationexpression = "^([0-9a-zA-Z]([-.\\w]*[0-9a-zA-Z])*@([0-9a-zA-Z][-\\w]*[0-9a-zA-Z]\\.)+[a-zA-Z]{2,9})$";
var PostComment_ascx_vldUrl = document.all ? document.all["PostComment_ascx_vldUrl"] : document.getElementById("PostComment_ascx_vldUrl");
PostComment_ascx_vldUrl.controltovalidate = "PostComment_ascx_tbUrl";
PostComment_ascx_vldUrl.errormessage = "Url is not required, but it must be valid if specified.";
PostComment_ascx_vldUrl.display = "Dynamic";
PostComment_ascx_vldUrl.validationGroup = "SubtextComment";
PostComment_ascx_vldUrl.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
PostComment_ascx_vldUrl.validationexpression = "^(https?://)?([\\w-]+\\.)+[\\w-]+(/[\\w-./?%&=]*)?$";
var PostComment_ascx_RequiredFieldValidator3 = document.all ? document.all["PostComment_ascx_RequiredFieldValidator3"] : document.getElementById("PostComment_ascx_RequiredFieldValidator3");
PostComment_ascx_RequiredFieldValidator3.controltovalidate = "PostComment_ascx_tbComment";
PostComment_ascx_RequiredFieldValidator3.errormessage = "Please enter a comment";
PostComment_ascx_RequiredFieldValidator3.validationGroup = "SubtextComment";
PostComment_ascx_RequiredFieldValidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
PostComment_ascx_RequiredFieldValidator3.initialvalue = "";
var PostComment_ascx_ctl00 = document.all ? document.all["PostComment_ascx_ctl00"] : document.getElementById("PostComment_ascx_ctl00");
PostComment_ascx_ctl00.errormessage = "Please enter the answer to the supplied question.";
PostComment_ascx_ctl00.display = "Dynamic";
PostComment_ascx_ctl00.validationGroup = "SubtextComment";
var PostComment_ascx_captcha = document.all ? document.all["PostComment_ascx_captcha"] : document.getElementById("PostComment_ascx_captcha");
PostComment_ascx_captcha.errormessage = "Please enter the correct word";
PostComment_ascx_captcha.display = "Dynamic";
PostComment_ascx_captcha.validationGroup = "SubtextComment";
// -->
</script>

<div>

	<input type="hidden" name="__SCROLLPOSITIONX" id="__SCROLLPOSITIONX" value="0" />
	<input type="hidden" name="__SCROLLPOSITIONY" id="__SCROLLPOSITIONY" value="0" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWGgL+raDpAgL+3ZGoBALZ0YTdDQL4oNG+CQLTntyYCQKKxo21BQLluYDqDgLUw76tDQKvt7HiBgKm1I3fAwKByICUDQL+3YXIBALZ0fj8DQL4oMXeCQLTntC4CQKKxoHVBQLlufSJDwLUw7LNDQKvt6WCBwKyqIecCQLH9YpTAq+a5rsPAoqv5pwLAq/bzYAMAqX8uYIOAsnZ7LoEO9kwHGcLuJ9NNe4Avmpiro9aSAg=" />
</div>

			<script type="text/javascript">
			    if (typeof(AJAXCbo) == 'undefined')
					alert("Unable to find script library '/AjaxCallObject.js'. Copy the file to the required location, or change the 'scriptPath' setting at magicAjax section of web.config.");
				else
					AJAXCbo.HookAjaxCall(false,false,false,"Form1");
			</script>
<script type="text/javascript">
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</script>
        <script type="text/javascript">
subtext_invisible_captcha_hideFromJavascriptEnabledBrowsers('PostComment_ascx_ctl00_subtext_captcha');
</script><script type="text/javascript">
subtext_invisible_captcha_setAnswer(6, 3, 'PostComment_ascx_ctl00_answer');
</script>
<script type="text/javascript">
<!--

theForm.oldSubmit = theForm.submit;
theForm.submit = WebForm_SaveScrollPositionSubmit;

theForm.oldOnSubmit = theForm.onsubmit;
theForm.onsubmit = WebForm_SaveScrollPositionOnSubmit;
// -->
</script>
<script type='text/javascript'>AJAXCbo.SetFieldIfEmpty("__CONTROL_FINGERPRINTS_apnlCommentsWrapper","BD804C1");</script></form>
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
    </script>
    <script type="text/javascript">
    _uacct = "UA-222470-4";
    urchinTracker();
    </script>
	</body>
</html>
